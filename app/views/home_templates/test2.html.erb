<form action="/address_to_coordinates" method="post">

  <div>
    <label for="address_box">Address</label>
    <input id="address_box" name="query_address" placeholder="Enter an address" type="text">
  </div>

  <button>
    Look it up!
  </button>
  
  <ul>
    <li>Address: <%= @address %></li>
    <li>Latitude: <%= @latitude %></li>
    <li>Longitude: <%= @longitude %></li>
    <li>Timezone: <%= @timezone %></li>
    <li>Timezone Offset: <%= @timezone_offset %></li>
    <li><%= @first_dt %></li>
    <li><%= @first_result %></li>
  </ul>

<% if @rain %>
  Rain is in the forecast, with up to a <%= (@max_pop*100).round(2).to_i %>% chance at <%= @datetime_of_max_pop.in_time_zone(@timezone).strftime("%-l%P")  %>.
<% else %>
  No rain today!
<% end %>

<table>
  <tr>
    <th>Local Datetime (<%= @timezone %>) </th>
    <th>Weather Category</th>
    <th>Weather Description</th>
    <th>Probability of Precipitation</th>
  </tr>
  <% @hourly_array.each do |hour_forecast| %>
    <tr>
      <td>
        <% datetime = DateTime.strptime(hour_forecast.fetch("dt").to_s,'%s') %>
        <%= datetime.in_time_zone(@timezone).strftime("%b %-d, %Y %-l %p %Z")  %>       
      </td>
      <td><%= hour_forecast.fetch("weather").first.fetch("main") %></td>
      <td><%= hour_forecast.fetch("weather").first.fetch("description") %></td>
      <td><%= hour_forecast.fetch("pop") %></td>
    </tr>
  <% end %>
</table>

</form>